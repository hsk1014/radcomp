<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Radiology Clinics</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; }
    #map { margin: 20px auto; }
    #clinic-info { display: none; border: 1px solid #ccc; padding: 10px; margin: 20px; }
    button { margin-top: 10px; }
  </style>
</head>
<body>
  <h1>Radiology Clinic Locator</h1>
  <!-- Display the static map image -->
  <img id="map" src="" alt="Map" style="cursor: pointer;">
  
  <!-- Hidden info panel to show clinic details -->
  <div id="clinic-info">
    <h2 id="clinic-name"></h2>
    <p id="clinic-address"></p>
    <p id="clinic-services"></p>
    <p id="clinic-fee"></p>
    <button onclick="closeInfo()">Close</button>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script>
    // Initialize Supabase client with your project details
    const supabaseUrl = 'https://tcodvpbzoczyfrtjqddu.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRjb2R2cGJ6b2N6eWZydGpxZGR1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzgyMjk2NzgsImV4cCI6MjA1MzgwNTY3OH0.4L2reZet-Jh7FH-r6zLbKmmusZum1VUtTv_K2IsmZ2o';
    const supabase = supabase.createClient(supabaseUrl, supabaseKey);
  
    async function loadClinicData() {
      const { data, error } = await supabase
        .from('clinics')
        .select('*')
        .limit(1); // For now, we expect only one clinic
      if (error) {
        console.error('Error fetching clinic data:', error);
        return;
      }
      if (data.length > 0) {
        const clinic = data[0];
  
        // Build the Google Maps Static API URL using the clinic's coordinates
        const googleMapsApiKey = 'AIzaSyBSR5pRoUVRr1NmyJlJxK4XHNuHoIJT9PA';
        const mapUrl = `https://maps.googleapis.com/maps/api/staticmap?center=${clinic.latitude},${clinic.longitude}&zoom=15&size=600x300&markers=color:red%7C${clinic.latitude},${clinic.longitude}&key=${googleMapsApiKey}`;
        document.getElementById("map").src = mapUrl;
  
        // Set up the click event to show clinic details
        document.getElementById("map").addEventListener("click", () => {
          document.getElementById("clinic-name").textContent = clinic.name;
          document.getElementById("clinic-address").textContent = clinic.address;
          document.getElementById("clinic-services").textContent = "Services: " + clinic.services.join(", ");
          document.getElementById("clinic-fee").textContent = "Bulk Bill: " + (clinic.bulk_bill ? "Yes" : "No");
          document.getElementById("clinic-info").style.display = "block";
        });
      }
    }
  
    // Load the clinic data when the page loads
    loadClinicData();
  </script>
</body>
</html>
